// Copyright 2025 The ODML Authors.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// TODO(b/445163709): Remove this module once litert_lm publishes a pypi
// package.

syntax = "proto3";

package litert.lm.proto;

import "litert/python/internal/token.proto";

// The model type of the LLM.
message LlmModelType {
  // The model type here are predefined model types that LiteRT-LM team
  // supports.
  oneof model_type {
    GenericModel generic_model = 1;
    Gemma3N gemma3n = 2;
    Gemma3 gemma3 = 4;
    Qwen3 qwen3 = 5;
    Qwen2p5 qwen2p5 = 7;
  }
  reserved 3, 6;
}

// The default model type for the generic model.
message GenericModel {}

// Google's Gemma3N model.
message Gemma3N {
  // Vision modality.
  // The start of image token indicates the start of image in the prompt.
  TokenUnion start_of_image_token = 1;
  // The end of image token indicates the end of image in the prompt.
  TokenUnion end_of_image_token = 2;
  // The height of the image tensor that image preprocessor should resize to.
  int32 image_tensor_height = 3;
  // The width of the image tensor that image preprocessor should resize to.
  int32 image_tensor_width = 4;

  // Audio modality.
  // The start of audio token indicates the start of audio in the prompt.
  TokenUnion start_of_audio_token = 5;
  // The end of audio token indicates the end of audio in the prompt.
  TokenUnion end_of_audio_token = 6;
}

// Google's Gemma3 model.
message Gemma3 {
  // Vision modality.
  // The start of image token indicates the start of image in the prompt.
  TokenUnion start_of_image_token = 1;
  // The end of image token indicates the end of image in the prompt.
  TokenUnion end_of_image_token = 2;
  // The height of the image tensor that image preprocessor should resize to.
  int32 image_tensor_height = 3;
  // The width of the image tensor that image preprocessor should resize to.
  int32 image_tensor_width = 4;
}

// Qwen3 model.
message Qwen3 {
  // Options for tool calling.
  // Signifies the beginning of a tool call.
  optional string code_fence_start = 1;
  // Signifies the end of tool call.
  optional string code_fence_end = 2;
  // Whether to escape the fence strings for regex matching.
  optional bool escape_fence_strings = 3;
  // An optional regex to match each line of the tool code block.
  optional string tool_code_regex = 4;
}

// Qwen2.5 model.
message Qwen2p5 {
  // Options for tool calling.
  // Signifies the beginning of a tool call.
  optional string code_fence_start = 1;
  // Signifies the end of tool call.
  optional string code_fence_end = 2;
  // Whether to escape the fence strings for regex matching.
  optional bool escape_fence_strings = 3;
  // An optional regex to match each line of the tool code block.
  optional string tool_code_regex = 4;
}
